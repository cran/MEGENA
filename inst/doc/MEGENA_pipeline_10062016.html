<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Won-Min Song" />

<meta name="date" content="2017-01-04" />

<title>MEGENA_pipeline</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">MEGENA_pipeline</h1>
<h4 class="author"><em>Won-Min Song</em></h4>
<h4 class="date"><em>January 04, 2017</em></h4>



<div id="megena-pipeline-as-of-10252016" class="section level2">
<h2>MEGENA pipeline as of 10/25/2016</h2>
<p>This is a routine MEGENA pipeline description encompassing from data correlation analysis to module plotting, and is based on version 1.3.6 <a href="https://CRAN.R-project.org/package=MEGENA" class="uri">https://CRAN.R-project.org/package=MEGENA</a>.Please cite the paper below when MEGENA is applied as part of your analysis:</p>
<p>Song W.-M., Zhang B. (2015) Multiscale Embedded Gene Co-expression Network Analysis. PLoS Comput Biol 11(11): e1004574. doi: 10.1371/journal.pcbi.1004574.</p>
<p>For statistical mechanics aspects involved in MEGENA, please check:</p>
<p>Song W.-M., Di Matteo T.and Aste T., Building Complex Networks with Platonic Solids, Physical Reivew E, 2012 Apr;85(4 Pt 2):046115.</p>
</div>
<div id="calculate-correlation" class="section level1">
<h1>calculate correlation</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>()) <span class="co"># rm R working space</span>

<span class="kw">library</span>(MEGENA)

<span class="co"># input parameters</span>
n.cores &lt;-<span class="st"> </span><span class="dv">2</span>; <span class="co"># number of cores/threads to call for PCP</span>
doPar &lt;-<span class="ot">TRUE</span>; <span class="co"># do we want to parallelize?</span>
method =<span class="st"> &quot;pearson&quot;</span> <span class="co"># method for correlation. either pearson or spearman. </span>
FDR.cutoff =<span class="st"> </span><span class="fl">0.05</span> <span class="co"># FDR threshold to define significant correlations upon shuffling samples. </span>
module.pval =<span class="st"> </span><span class="fl">0.05</span> <span class="co"># module significance p-value. Recommended is 0.05. </span>
hub.pval =<span class="st"> </span><span class="fl">0.05</span> <span class="co"># connectivity significance p-value based random tetrahedral networks</span>
cor.perm =<span class="st"> </span><span class="dv">10</span>; <span class="co"># number of permutations for calculating FDRs for all correlation pairs. </span>
hub.perm =<span class="st"> </span><span class="dv">100</span>; <span class="co"># number of permutations for calculating connectivity significance p-value. </span>

<span class="co"># annotation to be done on the downstream</span>
annot.table=<span class="ot">NULL</span>
id.col =<span class="st"> </span><span class="dv">1</span>
symbol.col=<span class="st"> </span><span class="dv">2</span>
###########

<span class="kw">data</span>(Sample_Expression) <span class="co"># load toy example data</span>

ijw &lt;-<span class="st"> </span><span class="kw">calculate.correlation</span>(datExpr,<span class="dt">doPerm =</span> cor.perm,<span class="dt">output.corTable =</span> <span class="ot">FALSE</span>,<span class="dt">output.permFDR =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## i = 1
## i = 2
## i = 3
## i = 4
## i = 5
## i = 6
## i = 7
## i = 8
## i = 9
## i = 10</code></pre>
</div>
<div id="calculate-pfn" class="section level1">
<h1>calculate PFN</h1>
<p>In this step, Planar Filtered Network (PFN) is calculated by taking significant correlation pairs, ijw. In the case of utilizing a different similarity measure, one can independently format the results into 3-column data frame with column names c(“row”,“col”,“weight”), and make sure the weight column ranges within 0 to 1. Using this as an input to calculate.PFN() will work just as fine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">#### register multiple cores if needed: note that set.parallel.backend() is deprecated. 
if (doPar &amp;<span class="st"> </span><span class="kw">getDoParWorkers</span>() ==<span class="st"> </span><span class="dv">1</span>)
{
  cl &lt;-<span class="st"> </span>parallel::<span class="kw">makeCluster</span>(n.cores)
  <span class="kw">registerDoParallel</span>(cl)
  <span class="co"># check how many workers are there</span>
  <span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;number of cores to use:&quot;</span>,<span class="kw">getDoParWorkers</span>(),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))
}</code></pre></div>
<pre><code>## number of cores to use:2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##### calculate PFN
el &lt;-<span class="st"> </span><span class="kw">calculate.PFN</span>(ijw[,<span class="dv">1</span>:<span class="dv">3</span>],<span class="dt">doPar =</span> doPar,<span class="dt">num.cores =</span> n.cores,<span class="dt">keep.track =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## ####### PFN Calculation commences ########
## [1] &quot;343 out of 894 has been included.&quot;
## [1] &quot;471 out of 894 has been included.&quot;
## [1] &quot;556 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 249&quot;
## [1] &quot;663 out of 894 has been included.&quot;
## [1] &quot;710 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 78&quot;
## [1] &quot;759 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 60&quot;
## [1] &quot;802 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 24&quot;
## [1] &quot;820 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 21&quot;
## [1] &quot;839 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 14&quot;
## [1] &quot;850 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 5&quot;
## [1] &quot;853 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 4&quot;
## [1] &quot;857 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 3&quot;
## [1] &quot;860 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 3&quot;
## [1] &quot;863 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 5&quot;
## [1] &quot;867 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 1&quot;
## [1] &quot;868 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 4&quot;
## [1] &quot;872 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 10&quot;
## [1] &quot;875 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 1&quot;
## [1] &quot;876 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 2&quot;
## [1] &quot;878 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 5&quot;
## [1] &quot;881 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 5&quot;
## [1] &quot;884 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 19&quot;
## [1] &quot;888 out of 894 has been included.&quot;
## [1] &quot;Performing parallel quality checks on 2000&quot;
## [1] &quot;Qualified edges: 217&quot;
## [1] &quot;894 out of 894 has been included.&quot;
## [1] &quot;PFG is complete.&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw">graph.data.frame</span>(el,<span class="dt">directed =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="perform-clustering" class="section level1">
<h1>perform clustering</h1>
<p>MCA clustering is performed to identify multiscale clustering analysis. “MEGENA.output”&quot; is the core output to be used in the down-stream analyses for summarization and plotting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##### perform MCA clustering.
MEGENA.output &lt;-<span class="st"> </span><span class="kw">do.MEGENA</span>(g,
 <span class="dt">mod.pval =</span> module.pval,<span class="dt">hub.pval =</span> hub.pval,<span class="dt">remove.unsig =</span> <span class="ot">TRUE</span>,
 <span class="dt">min.size =</span> <span class="dv">10</span>,<span class="dt">max.size =</span> <span class="kw">vcount</span>(g)/<span class="dv">2</span>,
 <span class="dt">doPar =</span> doPar,<span class="dt">num.cores =</span> n.cores,<span class="dt">n.perm =</span> hub.perm,
 <span class="dt">save.output =</span> <span class="ot">FALSE</span>)

###### unregister cores as these are not needed anymore.
if (<span class="kw">getDoParWorkers</span>() &gt;<span class="st"> </span><span class="dv">1</span>)
{
  env &lt;-<span class="st"> </span>foreach:::.foreachGlobals
  <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>(<span class="dt">name=</span>env), <span class="dt">pos=</span>env)
}</code></pre></div>
</div>
<div id="summarize-results" class="section level1">
<h1>summarize results</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">summary.output &lt;-<span class="st"> </span><span class="kw">MEGENA.ModuleSummary</span>(MEGENA.output,
    <span class="dt">mod.pvalue =</span> module.pval,<span class="dt">hub.pvalue =</span> hub.pval,
    <span class="dt">min.size =</span> <span class="dv">10</span>,<span class="dt">max.size =</span> <span class="kw">vcount</span>(g)/<span class="dv">2</span>,
    <span class="dt">annot.table =</span> annot.table,<span class="dt">id.col =</span> id.col,<span class="dt">symbol.col =</span> symbol.col,
    <span class="dt">output.sig =</span> <span class="ot">TRUE</span>)

if (!<span class="kw">is.null</span>(annot.table))
{
  <span class="co"># update annotation to map to gene symbols</span>
  <span class="kw">V</span>(g)$name &lt;-<span class="st"> </span><span class="kw">paste</span>(annot.table[[symbol.col]][<span class="kw">match</span>(<span class="kw">V</span>(g)$name,annot.table[[id.col]])],<span class="kw">V</span>(g)$name,<span class="dt">sep =</span> <span class="st">&quot;|&quot;</span>)
  summary.output &lt;-<span class="st"> </span>output[<span class="kw">c</span>(<span class="st">&quot;mapped.modules&quot;</span>,<span class="st">&quot;module.table&quot;</span>)]
  <span class="kw">names</span>(summary.output)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;modules&quot;</span>
}

<span class="kw">print</span>(<span class="kw">head</span>(summary.output$modules,<span class="dv">2</span>))</code></pre></div>
<pre><code>## $c1_2
##   [1] &quot;C1QB&quot;         &quot;C1QA&quot;         &quot;SASH3&quot;        &quot;HLA-DPA1&quot;    
##   [5] &quot;PLEK&quot;         &quot;NCKAP1L&quot;      &quot;EVI2B&quot;        &quot;HLA-DRA&quot;     
##   [9] &quot;FCGR1A&quot;       &quot;CD53&quot;         &quot;PTPRC&quot;        &quot;DOCK2&quot;       
##  [13] &quot;ITGB2&quot;        &quot;FCGR1C&quot;       &quot;ARHGAP9&quot;      &quot;CD37&quot;        
##  [17] &quot;CD4&quot;          &quot;PTPN7&quot;        &quot;HLA-DMB&quot;      &quot;CD48&quot;        
##  [21] &quot;FYB&quot;          &quot;CYBB&quot;         &quot;IKZF1&quot;        &quot;LILRB2&quot;      
##  [25] &quot;HLA-DQA1&quot;     &quot;LILRB4&quot;       &quot;IL10RA&quot;       &quot;CCR5&quot;        
##  [29] &quot;HLA-DPB1&quot;     &quot;LILRB1&quot;       &quot;CORO1A&quot;       &quot;SPN&quot;         
##  [33] &quot;PSTPIP1&quot;      &quot;SNX20&quot;        &quot;MNDA&quot;         &quot;TFEC&quot;        
##  [37] &quot;FGL2&quot;         &quot;CD74&quot;         &quot;C1QC&quot;         &quot;ITGAX&quot;       
##  [41] &quot;FERMT3&quot;       &quot;CCR1&quot;         &quot;PRKCB&quot;        &quot;CD1E&quot;        
##  [45] &quot;HLA-DQB1&quot;     &quot;IL12RB1&quot;      &quot;NCF1C&quot;        &quot;CLEC10A&quot;     
##  [49] &quot;FPR3&quot;         &quot;WDFY4&quot;        &quot;SP140&quot;        &quot;FCGR3A&quot;      
##  [53] &quot;CTSS&quot;         &quot;BIN2&quot;         &quot;SIGLEC7&quot;      &quot;TLR8&quot;        
##  [57] &quot;HLA-DRB1&quot;     &quot;IFI30&quot;        &quot;GPR183&quot;       &quot;NCF2&quot;        
##  [61] &quot;TMC8&quot;         &quot;MRC1&quot;         &quot;GIMAP5&quot;       &quot;CLEC17A&quot;     
##  [65] &quot;CD86&quot;         &quot;PIK3AP1&quot;      &quot;CSF1R&quot;        &quot;CD163&quot;       
##  [69] &quot;P2RY13&quot;       &quot;DOK2&quot;         &quot;CARD11&quot;       &quot;LILRB3&quot;      
##  [73] &quot;APOC1&quot;        &quot;IRF8&quot;         &quot;CRTAM&quot;        &quot;PARP15&quot;      
##  [77] &quot;AMICA1&quot;       &quot;SRGN&quot;         &quot;TNFRSF8&quot;      &quot;PLD4&quot;        
##  [81] &quot;MPEG1&quot;        &quot;CD1A&quot;         &quot;TMEM176A&quot;     &quot;EMB&quot;         
##  [85] &quot;RCSD1&quot;        &quot;FCGR1B&quot;       &quot;HCLS1&quot;        &quot;HLA-DOA&quot;     
##  [89] &quot;CIITA&quot;        &quot;AOAH&quot;         &quot;SLA&quot;          &quot;KLHL6&quot;       
##  [93] &quot;PIK3CG&quot;       &quot;CD84&quot;         &quot;SIGLEC10&quot;     &quot;CD1C&quot;        
##  [97] &quot;NCF1&quot;         &quot;CD226&quot;        &quot;PTPN22&quot;       &quot;IGSF6&quot;       
## [101] &quot;ZBP1&quot;         &quot;IL16&quot;         &quot;LYZ&quot;          &quot;HLA-DRB5&quot;    
## [105] &quot;CCR4&quot;         &quot;CD209&quot;        &quot;CD200R1&quot;      &quot;TLR10&quot;       
## [109] &quot;SIGLEC1&quot;      &quot;LOC100233209&quot; &quot;LILRA5&quot;       &quot;MYO1G&quot;       
## [113] &quot;CD28&quot;         &quot;CYTIP&quot;        &quot;PTAFR&quot;        &quot;HCK&quot;         
## [117] &quot;CSF1&quot;         &quot;TLR7&quot;         &quot;RAC2&quot;         &quot;ITGAL&quot;       
## [121] &quot;STAP1&quot;        &quot;RASGRP2&quot;      &quot;PTPRO&quot;        &quot;CD180&quot;       
## [125] &quot;P2RY12&quot;       &quot;EBI3&quot;         &quot;RASSF4&quot;       &quot;SIGLEC5&quot;     
## [129] &quot;FCN1&quot;         &quot;OSCAR&quot;        &quot;OLR1&quot;         &quot;FCGR2B&quot;      
## [133] &quot;NLRP2&quot;       
## 
## $c1_3
##   [1] &quot;CD3E&quot;      &quot;CD3D&quot;      &quot;CD2&quot;       &quot;CXCL11&quot;    &quot;ITK&quot;      
##   [6] &quot;ACAP1&quot;     &quot;IL2RG&quot;     &quot;PTPRCAP&quot;   &quot;SLAMF6&quot;    &quot;SH2D1A&quot;   
##  [11] &quot;SIRPG&quot;     &quot;CD5&quot;       &quot;NKG7&quot;      &quot;TIGIT&quot;     &quot;CD96&quot;     
##  [16] &quot;CD247&quot;     &quot;CXCR3&quot;     &quot;ICOS&quot;      &quot;LY9&quot;       &quot;TBC1D10C&quot; 
##  [21] &quot;UBASH3A&quot;   &quot;TAP1&quot;      &quot;LCK&quot;       &quot;GZMA&quot;      &quot;TBX21&quot;    
##  [26] &quot;GPR174&quot;    &quot;CCL5&quot;      &quot;CD38&quot;      &quot;CXCL10&quot;    &quot;C5orf20&quot;  
##  [31] &quot;IRF4&quot;      &quot;ZNF831&quot;    &quot;GBP5&quot;      &quot;LAX1&quot;      &quot;CD27&quot;     
##  [36] &quot;SLA2&quot;      &quot;KLRK1&quot;     &quot;GZMB&quot;      &quot;BTLA&quot;      &quot;HLA-B&quot;    
##  [41] &quot;SCML4&quot;     &quot;HLA-F&quot;     &quot;GZMK&quot;      &quot;HLA-H&quot;     &quot;SLAMF1&quot;   
##  [46] &quot;LOC400759&quot; &quot;SLAMF7&quot;    &quot;ZBED2&quot;     &quot;PRF1&quot;      &quot;IDO1&quot;     
##  [51] &quot;CD8B&quot;      &quot;IL4I1&quot;     &quot;ZAP70&quot;     &quot;GVIN1&quot;     &quot;FCRL3&quot;    
##  [56] &quot;FASLG&quot;     &quot;APOL1&quot;     &quot;PSMB9&quot;     &quot;AQP9&quot;      &quot;TNFRSF9&quot;  
##  [61] &quot;CXCL9&quot;     &quot;C8orf80&quot;   &quot;GBP1&quot;      &quot;HK3&quot;       &quot;ADAMDEC1&quot; 
##  [66] &quot;CD80&quot;      &quot;CTLA4&quot;     &quot;SLAMF8&quot;    &quot;TIFAB&quot;     &quot;CLEC4D&quot;   
##  [71] &quot;GPR18&quot;     &quot;SELL&quot;      &quot;APOL3&quot;     &quot;CLEC4E&quot;    &quot;PRKCQ&quot;    
##  [76] &quot;CARD16&quot;    &quot;CCL4&quot;      &quot;KLRC3&quot;     &quot;IL7R&quot;      &quot;SIT1&quot;     
##  [81] &quot;TRAT1&quot;     &quot;CD3G&quot;      &quot;GPR171&quot;    &quot;CD6&quot;       &quot;C16orf54&quot; 
##  [86] &quot;CD8A&quot;      &quot;CD40LG&quot;    &quot;EOMES&quot;     &quot;GZMM&quot;      &quot;LTA&quot;      
##  [91] &quot;MAP4K1&quot;    &quot;KIAA0748&quot;  &quot;SEPT1&quot;     &quot;CD52&quot;      &quot;PLA2G2D&quot;  
##  [96] &quot;HCP5&quot;      &quot;MEI1&quot;      &quot;CST7&quot;      &quot;LTB&quot;       &quot;XCL2&quot;     
## [101] &quot;AIM2&quot;      &quot;NLRC5&quot;     &quot;GNLY&quot;      &quot;IFNG&quot;      &quot;ETV7&quot;     
## [106] &quot;CTSW&quot;      &quot;ZNF683&quot;    &quot;C11orf21&quot;  &quot;CD69&quot;      &quot;PNOC&quot;     
## [111] &quot;IL2RB&quot;     &quot;TMEM150B&quot;  &quot;CCR8&quot;      &quot;LGALS2&quot;    &quot;LRMP&quot;     
## [116] &quot;BCL11B&quot;    &quot;IKZF3&quot;     &quot;UBD&quot;       &quot;MCART6&quot;    &quot;CCL3L1&quot;   
## [121] &quot;C15orf56&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(summary.output$module.table)</code></pre></div>
<pre><code>##       module.id module.size module.parent
## c1_2       c1_2         133          c1_1
## c1_3       c1_3         121          c1_1
## c1_4       c1_4          22          c1_1
## c1_5       c1_5          24          c1_1
## c1_6       c1_6         123          c1_2
## c1_8       c1_8          94          c1_3
## c1_10     c1_10          95          c1_6
##                                                                          module.hub
## c1_2  SASH3(34),CD53(33),PTPRC(26),CD86(20),NCKAP1L(19),FERMT3(19),PLEK(18),CD4(16)
## c1_3                                   CD2(33),CD3E(32),GBP5(20),ITK(19),SLAMF6(18)
## c1_4                                                                      MS4A1(12)
## c1_5                                                                      IFIT3(19)
## c1_6  SASH3(34),CD53(33),PTPRC(26),NCKAP1L(19),FERMT3(19),PLEK(18),CD86(17),CD4(16)
## c1_8                                            CD3E(32),CD2(32),ITK(19),SLAMF6(18)
## c1_10                   CD53(33),SASH3(29),FERMT3(19),PLEK(18),NCKAP1L(18),CD86(17)
##       module.scale module.pvalue
## c1_2            S2             0
## c1_3          &lt;NA&gt;             0
## c1_4            S2             0
## c1_5            S2             0
## c1_6          &lt;NA&gt;             0
## c1_8            S2             0
## c1_10           S1             0</code></pre>
</div>
<div id="plot-some-modules" class="section level1">
<h1>Plot some modules</h1>
<p>You can generate refined module network plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pnet.obj &lt;-<span class="st"> </span><span class="kw">plot_module</span>(<span class="dt">output.summary =</span> summary.output,<span class="dt">PFN =</span> g,<span class="dt">subset.module =</span> <span class="st">&quot;c1_3&quot;</span>,
    <span class="dt">layout =</span> <span class="st">&quot;kamada.kawai&quot;</span>,<span class="dt">label.hubs.only =</span> <span class="ot">TRUE</span>,
    <span class="dt">gene.set =</span> <span class="ot">NULL</span>,<span class="dt">color.code =</span>  <span class="st">&quot;grey&quot;</span>,
    <span class="dt">output.plot =</span> <span class="ot">FALSE</span>,<span class="dt">out.dir =</span> <span class="st">&quot;modulePlot&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;magenta&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;cyan&quot;</span>),<span class="dt">label.scaleFactor =</span> <span class="dv">20</span>,
    <span class="dt">hubLabel.col =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">hubLabel.sizeProp =</span> <span class="dv">1</span>,<span class="dt">show.topn.hubs =</span> <span class="ot">Inf</span>,<span class="dt">show.legend =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Processing module:c1_3
##  - # of genes: 121 
##  - # of hubs: 5 
## - generating module subnetwork figure...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#X11();</span>
<span class="kw">print</span>(pnet.obj[[<span class="dv">1</span>]])</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
</div>
<div id="plot-module-hierarchy" class="section level1">
<h1>plot module hierarchy</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">module.table &lt;-<span class="st"> </span>summary.output$module.table
<span class="kw">colnames</span>(module.table)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;id&quot;</span> <span class="co"># first column of module table must be labelled as &quot;id&quot;.</span>

hierarchy.obj &lt;-<span class="st"> </span><span class="kw">plot_module_hierarchy</span>(<span class="dt">module.table =</span> module.table,<span class="dt">label.scaleFactor =</span> <span class="fl">0.15</span>,
                                    <span class="dt">arrow.size =</span> <span class="fl">0.03</span>,<span class="dt">node.label.color =</span> <span class="st">&quot;blue&quot;</span>)
<span class="co">#X11();</span>
<span class="kw">print</span>(hierarchy.obj[[<span class="dv">1</span>]])</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
